(()=>{var e={};e.id=798,e.ids=[798],e.modules={2934:(e,r,s)=>{"use strict";s.r(r),s.d(r,{patchFetch:()=>q,routeModule:()=>g,serverHooks:()=>w,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>h});var t={};s.r(t),s.d(t,{POST:()=>x});var a=s(96559),n=s(48088),i=s(37719),o=s(32190),u=s(96330),p=s.n(u),d=s(85663);let{PrismaClient:l}=u,c=new l;process.on("beforeExit",async()=>{await c.$disconnect()});let{Gender:m}=p();async function x(e){try{let{name:r,email:s,phone:t,password:a,city:n,gender:i,parent:u}=await e.json(),p=[];if(r||p.push("Name is required"),s||p.push("Email is required"),t||p.push("Phone number is required"),a||p.push("Password is required"),n||p.push("City is required"),i||p.push("Gender is required"),p.length>0)return o.NextResponse.json({errors:p},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))return o.NextResponse.json({error:"Invalid email format"},{status:400});if(await c.user.findUnique({where:{phone:t}}))return o.NextResponse.json({error:"Phone number already registered"},{status:400});if(u&&!await c.user.findUnique({where:{phone:u}}))return o.NextResponse.json({error:"Parent phone number not found"},{status:400});let l="Homme"===i||"Male"===i||"homme"===i||"male"===i?"MALE":"Femme"===i||"Female"===i||"female"===i||"femme"===i?"FEMALE":null;if(!l)return o.NextResponse.json({error:"Invalid gender value, try again please"},{status:400});let x=await d.Ay.hash(a,10);if("MALE"===l){let e=await c.user.create({data:{name:r,phone:t,email:s,password:x,city:n,gender:m.MALE,parent:u||void 0}});return o.NextResponse.json({message:"User registered successfully",user:e},{status:201})}if("FEMALE"===l){let e=await c.user.create({data:{name:r,phone:t,email:s,password:x,city:n,gender:m.FEMALE}});return o.NextResponse.json({message:"User registered successfully",user:e},{status:201})}}catch(e){return console.error("Registration error:",e),o.NextResponse.json({error:e instanceof Error?e.message:"Registration failed"},{status:400})}}let g=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/users/register/route",pathname:"/api/users/register",filename:"route",bundlePath:"app/api/users/register/route"},resolvedPagePath:"D:\\Detofa\\Game\\detofa-games-backend\\src\\app\\api\\users\\register\\route.ts",nextConfigOutput:"",userland:t}),{workAsyncStorage:f,workUnitAsyncStorage:h,serverHooks:w}=g;function q(){return(0,i.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:h})}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[447,580,663],()=>s(2934));module.exports=t})();