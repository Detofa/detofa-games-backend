(()=>{var e={};e.id=665,e.ids=[665],e.modules={1693:(e,t,r)=>{"use strict";r.d(t,{W:()=>o});var s=r(43205),a=r.n(s);let n=process.env.JWT_SECRET;function o(e){let t=e.headers.get("authorization");if(!t||!t.startsWith("Bearer "))return null;let r=t.split(" ")[1];try{return a().verify(r,n).userId}catch(e){return console.error("JWT verification failed:",e),null}}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11486:(e,t,r)=>{"use strict";r.d(t,{D:()=>a});var s=r(88605);function a(e,t){let r=(0,s.a)(e,t?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}},11605:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>h,serverHooks:()=>w,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{POST:()=>g});var a=r(96559),n=r(48088),o=r(37719),i=r(32190),u=r(45455),c=r(1693),p=r(66445),l=r(12651),d=r(43689),f=r(11486);async function g(e){try{let t=(0,c.W)(e);if(!t)return i.NextResponse.json({error:"Unauthorized: userId missing"},{status:401});let{filter:r}=await e.json(),s=null,a=new Date;switch(r?.toLowerCase()){case"day":s=(0,p.o)(a);break;case"week":s=(0,l.k)(a,{weekStartsOn:1});break;case"month":s=(0,d.w)(a);break;case"year":s=(0,f.D)(a);break;default:s=null}let n=await u.A.score.findMany({where:{userId:t,...s?{createdAt:{gte:s}}:{}},orderBy:{createdAt:"desc"}}),o={};for(let e of n){let t=e.game;(!o[t]||e.score>o[t].score)&&(o[t]=e)}let g=Object.entries(o).map(([e,t])=>({game:e,score:t.score}));return i.NextResponse.json(g,{status:200})}catch(e){return console.error("Error in /scores/user/highest-per-game:",e),i.NextResponse.json({error:"Internal Server Error"},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/scores/highestpergame/route",pathname:"/api/scores/highestpergame",filename:"route",bundlePath:"app/api/scores/highestpergame/route"},resolvedPagePath:"D:\\Detofa\\Game\\detofa-games-backend\\src\\app\\api\\scores\\highestpergame\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:x,serverHooks:w}=h;function v(){return(0,o.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:x})}},12651:(e,t,r)=>{"use strict";r.d(t,{k:()=>n});let s={};var a=r(88605);function n(e,t){let r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0,n=(0,a.a)(e,t?.in),o=n.getDay();return n.setDate(n.getDate()-(7*(o<r)+o-r)),n.setHours(0,0,0,0),n}},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},43689:(e,t,r)=>{"use strict";r.d(t,{w:()=>a});var s=r(88605);function a(e,t){let r=(0,s.a)(e,t?.in);return r.setDate(1),r.setHours(0,0,0,0),r}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},45455:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=new(r(96330)).PrismaClient},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66445:(e,t,r)=>{"use strict";r.d(t,{o:()=>a});var s=r(88605);function a(e,t){let r=(0,s.a)(e,t?.in);return r.setHours(0,0,0,0),r}},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},88605:(e,t,r)=>{"use strict";r.d(t,{a:()=>a});let s=Symbol.for("constructDateFrom");function a(e,t){var r;return r=t||e,"function"==typeof r?r(e):r&&"object"==typeof r&&s in r?r[s](e):r instanceof Date?new r.constructor(e):new Date(e)}},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,580,205],()=>r(11605));module.exports=s})();